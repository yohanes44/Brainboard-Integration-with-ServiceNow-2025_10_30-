<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sysevent_script_action">
    <sysevent_script_action action="INSERT_OR_UPDATE">
        <active>true</active>
        <condition_script/>
        <description/>
        <event_name>x_854636_b_board.delete arch template</event_name>
        <name>Delete cat item</name>
        <order>100</order>
        <script><![CDATA[var archTplSysId = event.parm1;

var grArch = new GlideRecord('x_854636_b_board_architecture_template');
if (grArch.get(archTplSysId)) { // fetch the architecture template
    var catalogItemSysId = grArch.getValue('catalog_item');

    // Delete related io_set_item_list records/ variables
    var grVarItemList = new GlideRecord("item_option_new");
    grVarItemList.addQuery('cat_item', catalogItemSysId);
    grVarItemList.query();
    while (grVarItemList.next()) {
        grVarItemList.deleteRecord();
    }

    // Delete related io_set_item_set records/ catalog item and variable set connector
    var grVarItemSet = new GlideRecord("io_set_item");
    grVarItemSet.addQuery('sc_cat_item', catalogItemSysId);
    grVarItemSet.query();
    while (grVarItemSet.next()) {
        grVarItemSet.deleteRecord();
    }

	// Delete m2m records
    var grConnectedContent = new GlideRecord("m2m_connected_content");
    grConnectedContent.addQuery('catalog_item', catalogItemSysId);
    grConnectedContent.query();
    while (grConnectedContent.next()) {
        grConnectedContent.deleteRecord();
    }

	

    // Delete the catalog item
    if (catalogItemSysId) {
        var grCatItem = new GlideRecord('sc_cat_item_producer');
        if (grCatItem.get(catalogItemSysId)) {
            grCatItem.deleteRecord();
        }
    }

    // Delete the architecture template
    grArch.deleteRecord();
}
]]></script>
        <synchronous>false</synchronous>
        <sys_class_name>sysevent_script_action</sys_class_name>
        <sys_created_by>yohanes.yilma</sys_created_by>
        <sys_created_on>2025-08-29 08:44:15</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>cd470293c36322107e68b41ed40131b6</sys_id>
        <sys_mod_count>10</sys_mod_count>
        <sys_name>Delete cat item</sys_name>
        <sys_overrides/>
        <sys_package display_value="Brainboard" source="x_854636_b_board">7062797e832822103e53f065eeaad32b</sys_package>
        <sys_policy/>
        <sys_scope display_value="Brainboard">7062797e832822103e53f065eeaad32b</sys_scope>
        <sys_update_name>sysevent_script_action_cd470293c36322107e68b41ed40131b6</sys_update_name>
        <sys_updated_by>yohanes.yilma</sys_updated_by>
        <sys_updated_on>2025-09-03 20:19:26</sys_updated_on>
    </sysevent_script_action>
</record_update>
